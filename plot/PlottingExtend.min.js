OpenLayers.Renderer.Elements.prototype.drawGeometryNode=function(a,e,b){b=b||a._style;var c={isFilled:void 0===b.fill?!0:b.fill,isStroked:void 0===b.stroke?!!b.strokeWidth:b.stroke},d;e instanceof OpenLayers.Geometry.LinearRing?d=this.drawLinearRing(a,e):e instanceof OpenLayers.Geometry.LineString?(c.isFilled=!1,d=this.drawLineString(a,e)):e instanceof OpenLayers.Geometry.Polygon?d=this.drawPolygon(a,e):e instanceof OpenLayers.Geometry.Point?(!1===b.graphic&&(c.isFilled=!1,c.isStroked=!1),d=this.drawPoint(a,e)):e instanceof OpenLayers.Geometry.Rectangle&&(d=this.drawRectangle(a,e));a._options=c;return 0!=d?{node:this.setStyle(a,b,c,e),complete:d}:!1};OpenLayers.Renderer.SVG.prototype.getNodeType=function(a,e){var b=null;a instanceof OpenLayers.Geometry.LinearRing?b="polygon":a instanceof OpenLayers.Geometry.LineString?b="polyline":a instanceof OpenLayers.Geometry.Curve?b="path":a instanceof OpenLayers.Geometry.Polygon?b="path":a instanceof OpenLayers.Geometry.Point?b=e.externalGraphic?"image":this.isComplexSymbol(e.graphicName)?"svg":"circle":a instanceof OpenLayers.Geometry.Rectangle&&(b="rect");return b};OpenLayers.Renderer.VML.prototype.getNodeType=function(a,e){var b=null;a instanceof OpenLayers.Geometry.LinearRing?b="olv:shape":a instanceof OpenLayers.Geometry.LineString?b="olv:shape":a instanceof OpenLayers.Geometry.Curve?b="olv:shape":a instanceof OpenLayers.Geometry.Polygon?b="olv:shape":a instanceof OpenLayers.Geometry.Point?b=e.externalGraphic?"olv:rect":this.isComplexSymbol(e.graphicName)?"olv:shape":"olv:oval":a instanceof OpenLayers.Geometry.Rectangle&&(b="olv:rect");return b};OpenLayers.Renderer.Canvas.prototype.drawGeometry=function(a,e,b){var c=a.CLASS_NAME;if("OpenLayers.Geometry.Collection"==c||"OpenLayers.Geometry.MultiPoint"==c||"OpenLayers.Geometry.MultiLineString"==c||"OpenLayers.Geometry.MultiPolygon"==c)for(c=0;c<a.components.length;c++)this.drawGeometry(a.components[c],e,b);else a instanceof OpenLayers.Geometry.LinearRing?this.drawLinearRing(a,e,b):a instanceof OpenLayers.Geometry.LineString?this.drawLineString(a,e,b):a instanceof OpenLayers.Geometry.Polygon?this.drawPolygon(a,e,b):a instanceof OpenLayers.Geometry.Point?this.drawPoint(a,e,b):a instanceof OpenLayers.Geometry.Rectangle&&this.drawRectangle(a,e,b)};OpenLayers.Geometry.LineString.createCurve=function(a,e,b,c){var d="lanczos";void 0!=e&&(d=e);e=10;void 0!=b&&(e=b);d={method:d,clip:"mirror",lanczosFilterSize:e,cubicTension:0};e=[];for(b=0;b<a.length;b++)e.push([a[b].x,a[b].y]);d=Smooth(e,d);a=function(a,b){return Math.sqrt(Math.pow(a[0]-b[0],2)+Math.pow(a[1]-b[1],2))};var f=80;void 0!=c&&(f=c);c=[];var l,k;e=a(e[0],e[e.length-1])/f;for(f=0;1>f;f+=.5)for(k=[d(b+f),d(b+f+.5)],l=k[0],k=k[1],l=a(l,k),l=e/l,k=0;.5>k;k+=l){var h=d(b+f+k);c.push(new OpenLayers.Geometry.Point(h[0],h[1]))}h=d(b+1);c.push(new OpenLayers.Geometry.Point(h[0],h[1]));return new OpenLayers.Geometry.LineString(c)};OpenLayers.Geometry.LineString.createBspline=function(a,e){if(2>a.length)return null;var b=[],c=10;void 0!=e&&(c=e);var d,f,l,k,h,g,m;g=1/c;var n=Math.sqrt((Math.pow(a[1].x-a[0].x,2)+Math.pow(a[1].y-a[0].y,2))/2);d=new OpenLayers.Geometry.Point(a[0].x-n,a[0].y-n);n=[];n[0]=d;for(d=0;d<a.length-1;d++){var p=[];p[0]=a[d];f=new OpenLayers.Geometry.Point(2*a[d].x-n[d].x,2*a[d].y-n[d].y);p[1]=f;n[d+1]=f;p[2]=a[d+1];b.push(p[0]);for(f=0;f<=c;f++)k=f*g,m=k*k,l=(m-2*k+1)/2,k=(2*k-2*m+1)/2,h=m/2,m=l*p[0].x+k*p[1].x+h*p[2].x,l=l*p[0].y+k*p[1].y+h*p[2].y,b.push(new OpenLayers.Geometry.Point(m,l))}b.push(a[a.length-1]);return new OpenLayers.Geometry.LineString(b)};OpenLayers.Geometry.LineString.createBezier1=function(a,e,b){if(b)return OpenLayers.Geometry.LineString.createBezier3(a,b);b=[];for(var c=0;c<a.length;c++)b[c]=a[c];var d,f;a=0;var l;f=b.length;c=[];for(d=!0;d;){l=!0;for(d=0;d<f-3;d+=3){if(GetBezierGap(b,d)>e){l=!1;InciseBezier(b,d,c);b.splice(d+1,2);for(f=0;5>f;f++)b.splice(d+1+f,0,c[f+1]);d-=3;f=b.length}if(l)break}for(;a<f-1;)b[a]===b[a+1]&&(b.splice(a+1,1),f--),a++;d=!1}return new OpenLayers.Geometry.LineString(b)};OpenLayers.Geometry.LineString.calculatePointsFBZ2=function(a,e){e||(e=20);var b=[],c=.05;0<e&&(c=1/e);for(var d=0;d<a.length-2;){var f=a[d],l=a[d+1],k=a[d+2];b.push(f);for(var h=0;1>h;){var g=new OpenLayers.Geometry.Point((1-h)*(1-h)*f.x+2*h*(1-h)*l.x+h*h*k.x,(1-h)*(1-h)*f.y+2*h*(1-h)*l.y+h*h*k.y);b.push(g);h+=c}d+=2;d>=a.length&&b.push(f)}c=a[a.length-1];b[b.length-1].equals(c)||b.push(c.clone());return b};OpenLayers.Geometry.LineString.calculatePointsFBZ3=function(a,e){e||(e=20);var b=[],c=.05;0<e&&(c=1/e);for(var d=0;d<a.length-3;){var f=a[d],l=a[d+1],k=a[d+2],h=a[d+3];b.push(f);for(var g=0;1>g;){var m=new OpenLayers.Geometry.Point((1-g)*(1-g)*(1-g)*f.x+3*g*(1-g)*(1-g)*l.x+3*g*g*(1-g)*k.x+g*g*g*h.x,(1-g)*(1-g)*(1-g)*f.y+3*g*(1-g)*(1-g)*l.y+3*g*g*(1-g)*k.y+g*g*g*h.y);b.push(m);g+=c}d+=3;d>=a.length&&b.push(f)}c=a[a.length-1];b[b.length-1].equals(c)||b.push(c.clone());return b};OpenLayers.Geometry.LineString.calculatePointsFBZN=function(a,e){e||(e=8*a.length);var b=[],c=.05;0<e&&(c=1/e);for(var d=0;1>=d;){for(var f=0,l=0,k=a.length,h=0;h<a.length;h++)var g=OpenLayers.Geometry.LineString.BEZ(k-1,h,d),f=f+a[h].x*g,l=l+a[h].y*g;f=new OpenLayers.Geometry.Point(f,l);b.push(f);d+=c}c=a[a.length-1];b[b.length-1].equals(c)||b.push(c.clone());return b};OpenLayers.Geometry.LineString.createBezier2=function(a,e){var b=OpenLayers.Geometry.LineString.calculatePointsFBZ2(a,e);return new OpenLayers.Geometry.LineString(b)};OpenLayers.Geometry.LineString.createBezier3=function(a,e){var b=OpenLayers.Geometry.LineString.calculatePointsFBZ3(a,e);return new OpenLayers.Geometry.LineString(b)};OpenLayers.Geometry.LineString.createBezier=function(a,e){for(var b=[],c=0;c<a.length;c++)b[c]=a[c];var d,f=0,l;d=b.length;for(var k=[];;){l=!0;for(c=0;c<d-3;c+=3){if(GetBezierGap(b,c)>e){l=!1;InciseBezier(b,c,k);b.splice(c+1,2);for(d=0;5>d;d++)b.splice(c+1+d,0,k[d+1]);c-=3;d=b.length}if(l)break}for(;f<d-1;)b[f]===b[f+1]&&(b.splice(f+1,1),d--),f++;return new OpenLayers.Geometry.LineString(b)}};InciseBezier=function(a,e,b){var c=[[],[],[]],d;for(d=0;3>d;d++)c[0][d]=new OpenLayers.Geometry.Point,c[0][d].x=(a[e+d].x+a[e+d+1].x)/2,c[0][d].y=(a[e+d].y+a[e+d+1].y)/2;for(d=0;2>d;d++)c[1][d]=new OpenLayers.Geometry.Point,c[1][d].x=(c[0][d].x+c[0][d+1].x)/2,c[1][d].y=(c[0][d].y+c[0][d+1].y)/2;c[2][0]=new OpenLayers.Geometry.Point;c[2][0].x=(c[1][0].x+c[1][1].x)/2;c[2][0].y=(c[1][0].y+c[1][1].y)/2;b[0]=a[e];b[1]=c[0][0];b[2]=c[1][0];b[3]=c[2][0];b[4]=c[1][1];b[5]=c[0][2];b[6]=a[e+3];return!0};GetBezierGap=function(a,e){for(var b=0,c=1;4>c;c++)Math.abs(a[e+c].x-a[e+c-1].x)>b&&(b=Math.abs(a[e+c].x-a[e+c-1].x)),Math.abs(a[e+c].y-a[e+c-1].y)>b&&(b=Math.abs(a[e+c].y-a[e+c-1].y));return b};OpenLayers.Geometry.LineString.createBezierN=function(a,e){var b=OpenLayers.Geometry.LineString.calculatePointsFBZN(a,e);return new OpenLayers.Geometry.LineString(b)};OpenLayers.Geometry.LineString.BEZ=function(a,e,b){return OpenLayers.Geometry.LineString.combSort(a,e)*Math.pow(b,e)*Math.pow(1-b,a-e)};OpenLayers.Geometry.LineString.combSort=function(a,e){var b=OpenLayers.Geometry.LineString.factorial(a),c=OpenLayers.Geometry.LineString.factorial(e)*OpenLayers.Geometry.LineString.factorial(a-e);return b/c};OpenLayers.Geometry.LineString.factorial=function(a){for(var e=1,b=1;b<=a;b++)e*=b;return e};OpenLayers.Geometry.LineString.calculateCardinalPoints=function(a){if(null==a||3>a.length)return a;for(var e=[],b=a.length-1,c=0;c<=b+1-3;c++){var d=a[c],f=a[c+1],l=a[c+2],k=new OpenLayers.Geometry.Point,h=new OpenLayers.Geometry.Point,g=new OpenLayers.Geometry.Point(f.x-d.x,f.y-d.y),m=new OpenLayers.Geometry.Point(l.x-f.x,l.y-f.y),n=Math.sqrt(g.x*g.x+g.y*g.y),p=Math.sqrt(m.x*m.x+m.y*m.y),g=new OpenLayers.Geometry.Point(g.x/n,g.y/n),m=new OpenLayers.Geometry.Point(m.x/p,m.y/p),q=new OpenLayers.Geometry.Point(g.x+m.x,g.y+m.y),r=Math.sqrt(q.x*q.x+q.y*q.y),q=new OpenLayers.Geometry.Point(q.x/r,q.y/r);.005>Math.abs(1-(g.x*m.x+g.y*m.y)/1)?(k.x=f.x-m.x*n*.4,k.y=f.y-m.y*n*.4,h.x=f.x+g.x*p*.4,h.y=f.y+g.y*p*.4):(k.x=f.x-q.x*n*.4,k.y=f.y-q.y*n*.4,h.x=f.x+q.x*p*.4,h.y=f.y+q.y*p*.4);e[3*c+2]=k;e[3*c+3]=f;e[3*c+4]=h;0==c&&(f=new OpenLayers.Geometry.Point,k=new OpenLayers.Geometry.Point(k.x-d.x,k.y-d.y),g=Math.sqrt(k.x*k.x+k.y*k.y),k=new OpenLayers.Geometry.Point(k.x/g,k.y/g),f.x=d.x+k.x*n*.2,f.y=d.y+k.y*n*.2,e[3*c+0]=d,e[3*c+1]=f);c==b+1-3&&(d=new OpenLayers.Geometry.Point,h=new OpenLayers.Geometry.Point(h.x-l.x,h.y-l.y),n=Math.sqrt(h.x*h.x+h.y*h.y),h=new OpenLayers.Geometry.Point(h.x/n,h.y/n),d.x=l.x+h.x*p*.2,d.y=l.y+h.y*p*.2,e[3*c+5]=d,e[3*c+6]=l)}return e};OpenLayers.Geometry.LineString.createCloseCardinal=function(a){if(null==a||3>a.length)return a;a.push(a[0]);for(var e=[],b=a.length-1,c=0;c<=b-1;c++){if(c==b-1)var d=a[b-1],f=a[0],l=a[1];else d=a[c],f=a[c+1],l=a[c+2];var k=new OpenLayers.Geometry.Point,h=new OpenLayers.Geometry.Point,g=new OpenLayers.Geometry.Point(f.x-d.x,f.y-d.y),m=new OpenLayers.Geometry.Point(l.x-f.x,l.y-f.y),l=Math.sqrt(g.x*g.x+g.y*g.y),d=Math.sqrt(m.x*m.x+m.y*m.y),g=new OpenLayers.Geometry.Point(g.x/l,g.y/l),m=new OpenLayers.Geometry.Point(m.x/d,m.y/d),n=new OpenLayers.Geometry.Point(g.x+m.x,g.y+m.y),p=Math.sqrt(n.x*n.x+n.y*n.y),n=new OpenLayers.Geometry.Point(n.x/p,n.y/p);.005>Math.abs(1-(g.x*m.x+g.y*m.y)/1)?(k.x=f.x-m.x*l*.4,k.y=f.y-m.y*l*.4,h.x=f.x+g.x*d*.4,h.y=f.y+g.y*d*.4):(k.x=f.x-n.x*l*.4,k.y=f.y-n.y*l*.4,h.x=f.x+n.x*d*.4,h.y=f.y+n.y*d*.4);c==b-1?(e[0]=f,e[1]=h,e[3*(b-2)+5]=k,e[3*(b-2)+6]=a[b]):(e[3*c+2]=k,e[3*c+3]=f,e[3*c+4]=h)}return e};OpenLayers.Util.copyAttributes=function(a,e){a=a||{};if(e)for(var b in e){var c=e[b];void 0!==c&&"CLASS_NAME"!=b&&"function"!=typeof c&&(a[b]=c)}return a};